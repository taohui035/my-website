<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>Taozhiruo.com | 创意空间</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Taozhiruo 的个人网站：创意、技术与生活灵感。">
  <meta property="og:title" content="Taozhiruo | 创意空间">
  <meta property="og:description" content="探索我的数字世界：项目、设计与AI应用作品集。">
  <meta property="og:type" content="website">
  <meta property="og:locale" content="zh_CN">
  <meta name="twitter:card" content="summary_large_image">

  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;800;900&family=Noto+Sans+SC:wght@300;400;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --primary-hex:#00bcd4; --primary-rgb:0,188,212;
      --secondary-hex:#ff4081; --secondary-rgb:255,64,129;
      --text-color:#ecf0f1; --bg-dark:#0f1b27;
      --glass-bg:rgba(255,255,255,.08); --glass-border:rgba(255,255,255,.1);
      --radius:16px; --blur:15px;
    }
    /* —— 随系统时间自动换色（早/午/晚/夜） —— */
    body.palette-morning{--primary-hex:#ffb86b;--primary-rgb:255,184,107;--secondary-hex:#ff79c6;--secondary-rgb:255,121,198;--bg-dark:#0f1b27;}
    body.palette-noon   {--primary-hex:#00bcd4;--primary-rgb:0,188,212;--secondary-hex:#7c4dff;--secondary-rgb:124,77,255;--bg-dark:#0e1e2c;}
    body.palette-evening{--primary-hex:#ff8a65;--primary-rgb:255,138,101;--secondary-hex:#ffd54f;--secondary-rgb:255,213,79;--bg-dark:#0d1a28;}
    body.palette-night  {--primary-hex:#64b5f6;--primary-rgb:100,181,246;--secondary-hex:#b39ddb;--secondary-rgb:179,157,219;--bg-dark:#0a1621;}

    html{scroll-behavior:smooth}
    body{
      margin:0; padding:0;
      font-family:'Noto Sans SC','Montserrat',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      color:var(--text-color);
      background:
        radial-gradient(1200px 800px at 20% -10%, rgba(var(--primary-rgb),.16), transparent 60%),
        radial-gradient(1200px 800px at 80% 120%, rgba(var(--secondary-rgb),.12), transparent 60%),
        var(--bg-dark);
      overflow-x:hidden;
    }

    /* 顶部导航 */
    .navbar{position:fixed; inset:0 0 auto 0; padding:14px 5%;
      background:rgba(15,27,39,.70); backdrop-filter:blur(10px); -webkit-backdrop-filter:blur(10px);
      display:flex; justify-content:space-between; align-items:center; z-index:1000;
      transition:transform .4s ease, background-color .4s ease;
    }
    .navbar.nav-hidden{transform:translateY(-100%)} .navbar.nav-scrolled{background:rgba(15,27,39,.85)}
    .nav-logo{font-size:1.35rem; font-weight:800; color:#fff; text-decoration:none; letter-spacing:.3px}
    .nav-links{display:flex; gap:28px}
    .nav-links a{color:var(--text-color); text-decoration:none; font-weight:600; font-size:.98rem; position:relative}
    .nav-links a::after{content:''; position:absolute; left:50%; bottom:-6px; width:0; height:2px; background:var(--primary-hex); transform:translateX(-50%); transition:width .25s ease}
    .nav-links a:hover::after{width:100%}
    @media (max-width:768px){ .nav-links{display:none} }

    /* 背景视频 */
    .video-background{position:fixed; inset:0; overflow:hidden; z-index:-2}
    .video-background video{min-width:100%; min-height:100%; position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); object-fit:cover; filter:brightness(.62) saturate(1.02)}
    .video-overlay{position:fixed; inset:0; z-index:-1; background:linear-gradient(135deg, rgba(0,0,0,.68), rgba(0,0,0,.48))}

    /* Hero */
    .hero{min-height:72vh; display:flex; flex-direction:column; justify-content:center; align-items:center; padding:120px 20px 24px; text-align:center}
    .hero-title{
      font-family:'Montserrat',sans-serif; font-size:clamp(2.6rem,6vw,4.8rem); margin:0 0 16px; font-weight:900; letter-spacing:.5px;
      background:linear-gradient(90deg,var(--primary-hex),var(--secondary-hex),var(--primary-hex));
      -webkit-background-clip:text; background-clip:text; -webkit-text-fill-color:transparent;
      background-size:200% 100%; animation:gradMove 12s ease infinite;
    }
    .hero-desc{font-size:clamp(1rem,2.3vw,1.35rem); max-width:820px; margin:0 0 28px; font-weight:300; opacity:.95}
    .cta{display:inline-block; background:var(--primary-hex); color:#fff; padding:12px 28px; border-radius:999px; border:0; cursor:pointer; font-weight:800; letter-spacing:.3px; box-shadow:0 6px 18px rgba(var(--primary-rgb),.35); transition:transform .22s ease, box-shadow .22s ease, background .22s ease}
    .cta:hover{transform:translateY(-2px); background:var(--secondary-hex); box-shadow:0 10px 24px rgba(var(--secondary-rgb),.5)}
    @keyframes gradMove{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}

    /* —— 图片过渡桥（亚洲女明星风格 + 亚洲风景） —— */
    .bridge{position:relative; padding:8px 0 24px; min-height:48vh; display:flex; flex-direction:column; justify-content:flex-end; gap:16px}
    .bridge-mask{position:relative; width:100%; overflow:hidden; padding:24px 0}
    .bridge-mask::before,.bridge-mask::after{content:''; position:absolute; left:0; right:0; height:80px; z-index:2; pointer-events:none}
    .bridge-mask::before{top:0; background:linear-gradient(to bottom, rgba(0,0,0,.55), rgba(0,0,0,0))}
    .bridge-mask::after{bottom:0; background:linear-gradient(to top, rgba(0,0,0,.55), rgba(0,0,0,0))}
    .marquee{overflow:hidden}
    .marquee-track{display:flex; gap:16px; will-change:transform; animation:marquee var(--dur,46s) linear infinite}
    .row1 .marquee-track{--dur:46s}
    .row2 .marquee-track{--dur:58s; animation-direction:reverse}
    .bridge.paused .marquee-track{animation-play-state:paused}
    .bridge:hover .marquee-track{animation-play-state:paused}
    .bridge-img{width:28vw; max-width:520px; min-width:240px; height:22vh; min-height:160px; max-height:320px; object-fit:cover; border-radius:14px; filter:saturate(1.03) contrast(1.03); box-shadow:0 8px 22px rgba(0,0,0,.35)}
    .bridge-cta{align-self:center; background:transparent; border:1px solid rgba(255,255,255,.22); color:#fff; padding:10px 16px; border-radius:999px; cursor:pointer; opacity:.9}
    .bridge-cta:hover{opacity:1; border-color:rgba(255,255,255,.45)}
    @keyframes marquee{0%{transform:translateX(0)}100%{transform:translateX(-50%)}}

    /* —— 项目轮播（时尚科技风） —— */
    .section{min-height:100vh; display:flex; flex-direction:column; justify-content:center; align-items:center; padding:96px 20px 80px; text-align:center}
    .glass-card{background:var(--glass-bg); backdrop-filter:blur(var(--blur)); -webkit-backdrop-filter:blur(var(--blur)); border:1px solid var(--glass-border); border-radius:var(--radius); padding:36px; margin:18px auto; box-shadow:0 8px 32px rgba(0,0,0,.37); max-width:1000px; width:min(1000px,92%); opacity:0; transform:translateY(50px); transition:opacity .8s ease-out, transform .8s ease-out}
    .glass-card.fade-in{opacity:1; transform:translateY(0)}
    .glass-card h2{color:var(--primary-hex); font-size:clamp(1.6rem,3.5vw,2.4rem); margin:0 0 12px}

    .carousel{position:relative; width:100%; max-width:980px; margin:28px auto 0; overflow:hidden; border-radius:14px}
    .carousel-track{display:flex; transition:transform .6s cubic-bezier(.23,1,.32,1); will-change:transform; cursor:grab; touch-action:pan-y}
    .carousel-slide{min-width:100%; position:relative; transition:opacity .4s ease}
    .carousel-slide:not(.is-selected){opacity:.85}
    .carousel-slide picture, .carousel-slide img{display:block; width:100%}
    .carousel-slide img{height:52vh; max-height:560px; min-height:280px; object-fit:cover; filter:saturate(1.08) contrast(1.08)}
    .carousel-slide::after{content:""; position:absolute; inset:0; pointer-events:none; background:
      radial-gradient(1100px 600px at 15% 100%, rgba(var(--primary-rgb),.14), transparent 60%),
      radial-gradient(1100px 600px at 85% 0%,   rgba(var(--secondary-rgb),.12), transparent 60%);
    }
    .carousel-caption{position:absolute; inset:auto 0 0 0; background:linear-gradient(to top, rgba(0,0,0,.75), transparent); padding:34px 20px 18px; color:#fff; text-align:left}
    .carousel-caption h3{margin:0 0 4px; font-size:clamp(1.1rem,2.3vw,1.5rem); font-family:'Montserrat',sans-serif}
    .carousel-caption p{margin:0; font-size:.98em; color:rgba(255,255,255,.86)}
    .carousel-button{position:absolute; top:50%; transform:translateY(-50%); width:44px; height:44px; border-radius:50%; background:rgba(255,255,255,.1); border:1px solid rgba(255,255,255,.22); backdrop-filter:blur(5px); -webkit-backdrop-filter:blur(5px); display:flex; align-items:center; justify-content:center; cursor:pointer; transition:all .25s ease}
    .carousel-button:hover{background:rgba(255,255,255,.2); transform:translateY(-50%) scale(1.08)}
    .carousel-button-prev{left:16px} .carousel-button-next{right:16px}
    .carousel-button svg{width:24px; height:24px; stroke:#fff; stroke-width:2}
    .carousel-dots{position:absolute; bottom:14px; left:50%; transform:translateX(-50%); display:flex; gap:10px; z-index:2}
    .carousel-dot{width:10px; height:10px; border-radius:50%; background:rgba(255,255,255,.45); border:0; padding:0; cursor:pointer; transition:all .25s ease}
    .carousel-dot.is-selected{background:#fff; transform:scale(1.18)}
    .carousel-progress{position:absolute; left:14px; right:14px; bottom:10px; height:3px; background:rgba(255,255,255,.18); border-radius:2px; overflow:hidden; pointer-events:none; z-index:1}
    .carousel-progress .bar{width:0%; height:100%; background:linear-gradient(90deg, var(--primary-hex), var(--secondary-hex)); transition:none}

    .social-icons{display:flex; flex-wrap:wrap; justify-content:center; gap:14px; margin-top:18px}
    .social-btn{width:52px; height:52px; border-radius:50%; display:inline-flex; align-items:center; justify-content:center; background:var(--glass-bg); border:1px solid var(--glass-border); text-decoration:none; color:#fff; transition:all .22s ease}
    .social-btn:hover{transform:translateY(-3px); box-shadow:0 8px 22px rgba(0,0,0,.35); background:linear-gradient(135deg, rgba(var(--primary-rgb),.22), rgba(var(--secondary-rgb),.22))}
    .social-btn svg{width:22px; height:22px}

    @media (prefers-reduced-motion: reduce){
      *{animation-duration:0.001ms !important; animation-iteration-count:1 !important; transition-duration:0.001ms !important; scroll-behavior:auto !important}
      .marquee-track{animation:none}
    }
    @media (max-width:768px){ .bridge-img{width:60vw} }
  </style>
</head>
<body>
  <header role="banner">
    <nav class="navbar" aria-label="主导航">
      <a href="#" class="nav-logo">Taozhiruo.com</a>
      <div class="nav-links">
        <a href="#projects">我的项目</a>
        <a href="#contact">联系我</a>
      </div>
    </nav>
    <div class="video-background" aria-hidden="true">
      <video autoplay muted loop playsinline poster="background_poster.jpg"><source src="background_video.mp4" type="video/mp4" /></video>
    </div>
    <div class="video-overlay" aria-hidden="true"></div>
  </header>

  <main id="main">
    <section class="hero">
      <h1 class="hero-title">探索我的数字世界</h1>
      <p class="hero-desc">欢迎来到我的个人网站，这里是我分享创意、技术与生活灵感的专属空间。</p>
      <a href="#projects" class="cta">开始探索</a>
    </section>

    <!-- 图片过渡桥：亚洲女明星风格人像 + 亚洲风景壁纸（自动择图，按天轮换） -->
    <section id="bridge" class="bridge" aria-label="图像过渡">
      <div class="bridge-mask">
        <div class="marquee row1"><div class="marquee-track" id="marquee1"></div></div>
        <div class="marquee row2"><div class="marquee-track" id="marquee2"></div></div>
      </div>
      <button class="bridge-cta" type="button" aria-label="继续向下，查看项目" onclick="document.getElementById('projects').scrollIntoView({behavior:'smooth'})">↓ 继续向下</button>
    </section>

    <section id="projects" class="section" aria-labelledby="projects-title">
      <div class="glass-card">
        <h2 id="projects-title">我的项目</h2>
        <p>精选时尚科技风作品概念，聚焦界面、数据、AI 与未来体验。</p>

        <div class="carousel" role="region" aria-roledescription="carousel" aria-label="作品集轮播" tabindex="0" data-interval="4000">
          <ul class="carousel-track" aria-live="polite" id="projectTrack">
            <!-- 由脚本自动填充科技风 Slides -->
          </ul>

          <button class="carousel-button carousel-button-prev" aria-label="上一张" type="button">
            <svg viewBox="0 0 24 24" fill="none" stroke-linecap="round" stroke-linejoin="round"><path d="M15 18l-6-6 6-6"/></svg>
          </button>
          <button class="carousel-button carousel-button-next" aria-label="下一张" type="button">
            <svg viewBox="0 0 24 24" fill="none" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18l6-6-6-6"/></svg>
          </button>

          <div class="carousel-dots" role="tablist" aria-label="轮播分页点"></div>
          <div class="carousel-progress" aria-hidden="true"><div class="bar"></div></div>
        </div>
      </div>
    </section>

    <section id="contact" class="section" aria-labelledby="contact-title">
      <div class="glass-card">
        <h2 id="contact-title">联系我</h2>
        <p>如果你对我的项目感兴趣，或者想进行技术交流，欢迎随时与我联系。</p>
        <div class="social-icons" aria-label="社交链接">
          <a class="social-btn" href="https://x.com/home" target="_blank" rel="noopener" title="X / Twitter" aria-label="X / Twitter">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4l16 16M20 4L4 20"/></svg>
          </a>
          <a class="social-btn" href="https://github.com/" target="_blank" rel="noopener" title="GitHub" aria-label="GitHub">
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.91 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
          </a>
        </div>
      </div>
    </section>
  </main>

  <footer class="section" aria-label="页脚">
    <div class="glass-card" role="contentinfo">
      <p>© <span id="year"></span> Taozhiruo. 保留所有权利。</p>
    </div>
  </footer>

  <script>
  // ====== 工具：按“天”稳定随机（每天自动换新）
  function daySeed(){
    var d=new Date();
    return parseInt(String(d.getFullYear())+String(d.getMonth()+1).padStart(2,'0')+String(d.getDate()).padStart(2,'0'));
  }
  function mulberry32(a){return function(){var t=a+=0x6D2B79F5;t=Math.imul(t^t>>>15,t|1);t^=t+Math.imul(t^t>>>7,t|61);return((t^t>>>14)>>>0)/4294967296;}}
  function pickN(arr,n,rand){ var used=new Set(), out=[]; while(out.length<Math.min(n,arr.length)){ var i=Math.floor(rand()*arr.length); if(!used.has(i)){used.add(i); out.push(arr[i]);} } return out; }
  // 生成稳定图片（使用 picsum.photos 的 seed 机制，避免被预览拦截）
  function pic(w,h,seed){ return 'https://picsum.photos/seed/'+encodeURIComponent(seed)+'/'+w+'/'+h }

  document.addEventListener('DOMContentLoaded', function(){
    // 年份
    document.getElementById('year').textContent = new Date().getFullYear();

    // 系统时间调色板
    function getPaletteByHour(h){ if(h>=5&&h<11) return 'morning'; if(h>=11&&h<16) return 'noon'; if(h>=16&&h<20) return 'evening'; return 'night'; }
    function applyPalette(name){ document.body.classList.remove('palette-morning','palette-noon','palette-evening','palette-night'); document.body.classList.add('palette-'+name); }
    (function schedulePalette(){ applyPalette(getPaletteByHour(new Date().getHours())); setInterval(function(){applyPalette(getPaletteByHour(new Date().getHours()))}, 5*60*1000); })();

    // 智能导航
    var navbar=document.querySelector('.navbar');
    if(navbar){ var lastY=window.scrollY; window.addEventListener('scroll',function(){ var y=window.scrollY; if(y>100){ navbar.classList.add('nav-scrolled'); y>lastY? navbar.classList.add('nav-hidden'): navbar.classList.remove('nav-hidden'); }else{ navbar.classList.remove('nav-scrolled'); navbar.classList.remove('nav-hidden'); } lastY=y; }); }

    // ===== 过渡桥：亚洲女明星风格 + 亚洲风景（按天轮换） =====
    var prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    var rand = mulberry32(daySeed());

    var CELEB_SEEDS = ['asian-actress-1','asian-actress-2','korean-actress-1','japanese-actress-1','chinese-actress-1','studio-glam-1','neon-portrait-1','celebrity-portrait-2','minimal-portrait-1','soft-portrait-2'];
    var LAND_SEEDS  = ['tokyo-night','seoul-skyline','shanghai-skyline','kyoto-temple','mount-fuji','huangshan','jiuzhaigou','halong-bay','bali-beach','island-sunrise','coastline-asia'];

    function fillMarquee(el, seeds, count){
      var chosen = pickN(seeds, count, rand);
      var frag=document.createDocumentFragment();
      for(var r=0;r<2;r++){
        chosen.forEach(function(seed){
          var picEl = document.createElement('picture');
          var src800  = pic(800,500, seed+'-sm');
          var src1200 = pic(1200,750, seed+'-md');
          var src1600 = pic(1600,1000, seed+'-lg');
          picEl.innerHTML = '
            <source media="(max-width: 768px)" srcset="'+src800+'">
            <source media="(max-width: 1200px)" srcset="'+src1200+'">
            <img loading="lazy" decoding="async" src="'+src1600+'" alt="过渡图像：'+seed+'" class="bridge-img" onerror="this.src=\'https://placehold.co/1600x1000?text=Image\'">
          ';
          frag.appendChild(picEl);
        });
      }
      el.appendChild(frag);
    }

    var m1=document.getElementById('marquee1'); var m2=document.getElementById('marquee2');
    if(m1&&m2){ fillMarquee(m1, CELEB_SEEDS, 7); fillMarquee(m2, LAND_SEEDS, 9); }

    var bridgeSec=document.querySelector('.bridge');
    if(prefersReduced && bridgeSec){ bridgeSec.classList.add('paused'); }
    if(bridgeSec){
      var io=new IntersectionObserver(function(es){ es.forEach(function(e){ if(e.isIntersecting){ bridgeSec.classList.remove('paused'); } else { bridgeSec.classList.add('paused'); } }); },{threshold:.25});
      io.observe(bridgeSec);
      bridgeSec.addEventListener('mouseenter',function(){bridgeSec.classList.add('paused')});
      bridgeSec.addEventListener('mouseleave',function(){bridgeSec.classList.remove('paused')});
      bridgeSec.addEventListener('touchstart',function(){bridgeSec.classList.add('paused')},{passive:true});
      bridgeSec.addEventListener('touchend',function(){bridgeSec.classList.remove('paused')});
    }

    // ===== 项目轮播：科技风自动池 =====
    var TECH_SEEDS = ['futuristic-ui','cyberpunk-city','ai-abstract','robotics-tech','hud-interface','quantum-computing','server-room','neon-gradient','hologram-ui','chip-macro','code-grid'];
    var track = document.getElementById('projectTrack');
    var techChosen = pickN(TECH_SEEDS, 5, rand); // 5 张
    techChosen.forEach(function(seed,idx){
      var src800  = pic(800,500,seed+'-sm');
      var src1200 = pic(1200,750,seed+'-md');
      var src1600 = pic(1600,1000,seed+'-lg');
      var li = document.createElement('li');
      li.className = 'carousel-slide' + (idx===0?' is-selected':'');
      li.innerHTML = '
        <picture>
          <source media="(max-width: 768px)" srcset="'+src800+'">
          <source media="(max-width: 1200px)" srcset="'+src1200+'">
          <img loading="lazy" decoding="async" src="'+src1600+'" alt="时尚科技风：'+seed+'">
        </picture>
        <div class="carousel-caption">
          <h3>'+['未来界面','赛博城市','AI 视觉','智能硬件','科技纹理','量子计算','全息交互'][idx%7]+'</h3>
          <p>'+['霓虹质感的 UI 面板与微交互。','高饱和夜景与信息流捕捉。','抽象数据流的美学表达。','软硬整合的交互场景。','电路纹理与光栅细节之美。','前沿算力与新范式。','信息维度的可视化实验。'][idx%7]+'</p>
        </div>
      ';
      track.appendChild(li);
    });

    // 轮播交互（4s 自动播放 + 拖拽 + 键盘 + 进度条）
    var carousel=document.querySelector('.carousel'); 
    if(carousel){
      var slides=Array.from(track.children);
      var nextBtn=carousel.querySelector('.carousel-button-next');
      var prevBtn=carousel.querySelector('.carousel-button-prev');
      var dotsNav=carousel.querySelector('.carousel-dots');
      var progress=carousel.querySelector('.carousel-progress .bar');

      // 布局
      var slideWidth=slides[0].getBoundingClientRect().width;
      slides.forEach(function(s,i){ s.style.left=(slideWidth*i)+'px'; });
      function relayout(){ slideWidth=slides[0].getBoundingClientRect().width; slides.forEach(function(s,i){ s.style.left=(slideWidth*i)+'px'; }); moveTo(current,{instant:true}); }
      window.addEventListener('resize', relayout); window.addEventListener('orientationchange', relayout);
      slides.forEach(function(s){ var img=s.querySelector('img'); if(img && !img.complete){ img.addEventListener('load', relayout, {once:true}); } });

      // dots
      slides.forEach(function(_,i){ var b=document.createElement('button'); b.className='carousel-dot'+(i===0?' is-selected':''); b.setAttribute('aria-label','跳转到第 '+(i+1)+' 张'); b.addEventListener('click',function(){ moveTo(i); resetAuto(); }); dotsNav.appendChild(b); });
      var dots=Array.from(dotsNav.children);

      // 状态
      var current=0; var auto=null; var AUTO_MS=Number(carousel.dataset.interval||4000);

      function updateUI(i){
        slides[current].classList.remove('is-selected'); slides[i].classList.add('is-selected');
        dots[current].classList.remove('is-selected');   dots[i].classList.add('is-selected');
        current=i;
      }
      function moveTo(i,opts){
        opts = opts || {};
        var instant = !!opts.instant;
        var tx=-(slideWidth*i);
        var trackEl = document.querySelector('.carousel-track');
        if(instant){ var old=trackEl.style.transition; trackEl.style.transition='none'; trackEl.style.transform='translateX('+tx+'px)'; trackEl.offsetHeight; trackEl.style.transition=old||''; }
        else{ trackEl.style.transform='translateX('+tx+'px)'; }
        updateUI(i);
        if(!document.hidden){ resetProgress(); startProgress(); }
      }
      function next(){ moveTo((current+1)%slides.length); }
      function prev(){ moveTo((current-1+slides.length)%slides.length); }

      nextBtn.addEventListener('click',function(){ next(); resetAuto(); });
      prevBtn.addEventListener('click',function(){ prev(); resetAuto(); });

      // 拖拽
      var trackEl=document.querySelector('.carousel-track');
      var dragging=false, sx=0, stx=0, dx=0;
      trackEl.addEventListener('pointerdown',function(e){ dragging=true; trackEl.setPointerCapture(e.pointerId); sx=e.clientX; stx=-(slideWidth*current); trackEl.style.transition='none'; trackEl.style.cursor='grabbing'; stopAuto(); });
      window.addEventListener('pointermove',function(e){ if(!dragging) return; dx=e.clientX-sx; trackEl.style.transform='translateX('+(stx+dx)+'px)'; });
      window.addEventListener('pointerup',function(){ if(!dragging) return; dragging=false; trackEl.style.transition=''; trackEl.style.cursor='grab';
        var threshold=Math.min(90, slideWidth*.2); if(Math.abs(dx)>threshold){ dx<0? next(): prev(); } else { moveTo(current); } resetAuto(); });

      // 进度条 & 自动播放
      function startProgress(){ if(!progress) return; progress.style.transition='none'; progress.style.width='0%'; requestAnimationFrame(function(){ progress.style.transition='width '+AUTO_MS+'ms linear'; progress.style.width='100%'; }); }
      function resetProgress(){ if(!progress) return; progress.style.transition='none'; progress.style.width='0%'; }

      function startAuto(){ var reduce = window.matchMedia('(prefers-reduced-motion: reduce)').matches; if(reduce) return; stopAuto(); startProgress(); auto=setInterval(next, AUTO_MS); }
      function stopAuto(){ if(auto) clearInterval(auto); auto=null; resetProgress(); }
      function resetAuto(){ stopAuto(); startAuto(); }

      carousel.addEventListener('mouseenter', stopAuto);
      carousel.addEventListener('mouseleave', startAuto);
      document.addEventListener('visibilitychange',function(){ document.hidden? stopAuto(): startAuto(); });
      carousel.addEventListener('keydown', function(e){ if(e.key==='ArrowRight'){ next(); resetAuto(); } if(e.key==='ArrowLeft'){ prev(); resetAuto(); } });
      window.addEventListener('beforeunload', stopAuto);

      moveTo(0,{instant:true});
      startAuto();

      // 自检 + 额外测试
      console.groupCollapsed('%cSelf-Tests','color:#00bcd4');
      console.assert(String(carousel.dataset.interval)==='4000','data-interval 应为 4000');
      console.assert(dots.length===slides.length,'Dots 与 Slides 数量一致');
      // 额外测试：不传 opts 调用 moveTo 不应抛错
      try { moveTo(0); console.log('moveTo(0) 无 opts ✔'); } catch(e){ console.error('moveTo(0) 失败', e); }
      try { moveTo(0,{instant:true}); console.log('moveTo(0,{instant:true}) ✔'); } catch(e){ console.error('moveTo(0,{instant:true}) 失败', e); }
      console.groupEnd();
    }

    // 卡片渐入
    var io2=new IntersectionObserver(function(es){ es.forEach(function(e){ if(e.isIntersecting){ e.target.classList.add('fade-in'); } else { e.target.classList.remove('fade-in'); } }); },{threshold:.1});
    document.querySelectorAll('.glass-card').forEach(function(c){io2.observe(c)});
  });
  </script>
</body>
</html>
